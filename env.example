# =========================
# Polymarket MM Bot 配置示例
# =========================
#
# 说明：
# - 推荐：复制为 .env 后生效：cp env.example .env
# - 实盘请务必谨慎填写私钥与 L2 API 凭据（不要提交到仓库）
#

# --- Core ---
PMM_MODE=paper
PMM_DB_PATH=./data/pmm.sqlite
PMM_LOG_LEVEL=INFO

# --- Universe (Gamma) ---
PMM_GAMMA_HOST=https://gamma-api.polymarket.com
PMM_UNIVERSE_LIMIT=50
PMM_UNIVERSE_ORDER_FIELD=liquidityNum
PMM_UNIVERSE_ASCENDING=false
PMM_ONLY_ACTIVE=true
PMM_ONLY_OPEN=true

# --- Execution (CLOB) ---
PMM_CLOB_HOST=https://clob.polymarket.com
PMM_CHAIN_ID=137

# 实盘（live）需要：
PMM_PRIVATE_KEY=
PMM_SIGNATURE_TYPE=0
PMM_FUNDER=

# L2 API（用于 user websocket 记录真实成交/订单事件；实盘强烈建议填写）
PMM_API_KEY=
PMM_API_SECRET=
PMM_API_PASSPHRASE=

# --- Accounting ---
PMM_STARTING_CASH=1000

# --- Risk / sizing ---
PMM_ALPHA=1.5
PMM_MAX_USD_PER_MARKET=50
PMM_MIN_USD_PER_MARKET=5
PMM_MAX_GROSS_USD=500
PMM_POST_ONLY=true
PMM_TICK_BUFFER=0.0

# --- Strategy knobs ---
PMM_TARGET_SPREAD_BPS=60
PMM_QUOTE_REFRESH_SEC=3
PMM_CANCEL_REPRICE_SEC=15
PMM_MAX_ORDERS_PER_MARKET=2

# --- Capital allocation ---
PMM_ENABLE_ALLOCATOR=true
PMM_ALLOC_LIQUIDITY_POWER=0.5
PMM_ALLOC_QUALITY_K=2.0

# --- Trade tape (user websocket) ---
PMM_ENABLE_WSS_USER=true
PMM_WSS_BASE=wss://ws-subscriptions-clob.polymarket.com
PMM_WSS_PING_SEC=10

# --- Console dashboard / logging ---
PMM_RICH=true
PMM_DASHBOARD_REFRESH_SEC=1.0
PMM_CONSOLE_LOGS=false
PMM_RICH_LOGS=false
PMM_LOG_FILE=./data/pmm.log

# --- HTTP timeout（防止网络抖动卡死）---
PMM_HTTP_TIMEOUT_SEC=5.0

# --- Paper / Dry-run 模拟成交 ---
PMM_PAPER_SIM_ENABLE=true
PMM_PAPER_FILL_INTENSITY=0.0035

# 是否基于 orderbook 顶部深度做强度自适应（活跃市场更容易成交、冷门更少）
PMM_PAPER_INTENSITY_ADAPT=true
# 计算深度时使用盘口前 N 档（bids+asks size 之和）
PMM_PAPER_DEPTH_LEVELS=3
# depth_ref 参考值模式：
# - quantile：每轮采样 universe 的 depth_top，用分位数估计 depth_ref（推荐，减少手调）
# - static：固定使用 PMM_PAPER_DEPTH_REF
PMM_PAPER_DEPTH_REF_MODE=quantile
PMM_PAPER_DEPTH_REF_QUANTILE=0.70
# 深度参考值（static 模式或 quantile 兜底）
PMM_PAPER_DEPTH_REF=2000
# depth_ref 自动估计的夹逼与平滑（EMA）
PMM_PAPER_DEPTH_REF_MIN=200
PMM_PAPER_DEPTH_REF_MAX=50000
PMM_PAPER_DEPTH_REF_EMA=0.80
# 自适应后强度夹逼范围
PMM_PAPER_INTENSITY_MIN=0.0005
PMM_PAPER_INTENSITY_MAX=0.05

PMM_PAPER_SPREAD_K=0.6
# spread 惩罚模式：
# - intensity：把 spread 惩罚并入强度自适应（推荐，避免双重惩罚导致成交过少）
# - factor：在 simulate_fills 内部直接惩罚 p_fill
PMM_PAPER_SPREAD_MODE=intensity
PMM_PAPER_PARTIAL_FILL=true
PMM_PAPER_FULL_FILL_PROB=0.35
PMM_PAPER_PARTIAL_BETA_A=2.0
PMM_PAPER_PARTIAL_BETA_B=6.0
PMM_PAPER_PARTIAL_MIN_FRAC=0.05
PMM_PAPER_PARTIAL_MAX_FRAC=0.60
PMM_PAPER_MARKOUT_SIGMA_BPS=20

# --- Circuit Breaker（熔断阈值）---
# 实盘默认：撤单/分钟 > 120 会熔断
PMM_CB_MAX_CANCELS_PER_MIN=120
# paper/dry-run 默认更宽松，避免研究时因为“撤单重定价”被误熔断
PMM_CB_MAX_CANCELS_PER_MIN_PAPER=10000
